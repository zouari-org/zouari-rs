{"openapi":"3.1.0","info":{"title":"ZOUARI Platform API","description":"\nThe ZOUARI Platform API defines the official backend contract for all services within the ZOUARI ecosystem.  \nIt is built on a Secure-by-Design architecture using Rust and follows strict Zero-Trust, validation, and consistency principles.\n\nThis specification provides stable, well-typed, and predictable interfaces for all internal applications and automation systems.  \nIt serves as the single source of truth for request/response models, authentication flow, and service behavior across the platform.\n","contact":{"name":"Support Team / ZOUARI","url":"https://zouari.org","email":"support@zouari.org"},"license":{"name":"MIT"},"version":"1.1.0"},"paths":{"/api/auth/current":{"get":{"summary":"Get the currently authenticated user","operationId":"current","responses":{"200":{"description":"Current user data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrentResponse"}}}},"401":{"description":"Unauthorized"}},"security":[{"jwt_token":[]}]}},"/api/auth/forgot":{"post":{"summary":"In case the user forgot his password  this endpoints generate a forgot token\nand send email to the user. In case the email not found in our DB, we are\nreturning a valid request for for security reasons (not exposing users DB\nlist).","operationId":"forgot","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotParams"}}},"required":true},"responses":{"200":{"description":"Forgot password email sent (if user exists)"}},"security":[{}]}},"/api/auth/login":{"post":{"summary":"Creates a user login and returns a token","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginParams"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"Invalid credentials"}},"security":[{}]}},"/api/auth/magic-link":{"post":{"summary":"Magic link authentication provides a secure and passwordless way to log in to the application.","description":"# Flow\n1. **Request a Magic Link**:\n   A registered user sends a POST request to `/magic-link` with their email.\n   If the email exists, a short-lived, one-time-use token is generated and sent to the user's email.\n   For security and to avoid exposing whether an email exists, the response always returns 200, even if the email is invalid.\n\n2. **Click the Magic Link**:\n   The user clicks the link (/magic-link/{token}), which validates the token and its expiration.\n   If valid, the server generates a JWT and responds with a [`LoginResponse`].\n   If invalid or expired, an unauthorized response is returned.\n\nThis flow enhances security by avoiding traditional passwords and providing a seamless login experience.","operationId":"magic_link","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MagicLinkParams"}}},"required":true},"responses":{"200":{"description":"Magic link sent (if user exists and domain is valid)"},"400":{"description":"Invalid email domain"}},"security":[{}]}},"/api/auth/magic-link/{token}":{"get":{"summary":"Verifies a magic link token and authenticates the user.","operationId":"magic_link_verify","parameters":[{"name":"token","in":"path","description":"Magic link token","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Magic link login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"Invalid or expired magic link"}},"security":[{}]}},"/api/auth/register":{"post":{"summary":"Register function creates a new user with the given parameters and sends a\nwelcome email to the user","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterParams"}}},"required":true},"responses":{"200":{"description":"User registered. Verification email sent."},"400":{"description":"Invalid input"}},"security":[{}]}},"/api/auth/resend-verification-mail":{"post":{"summary":"Resend the verification email","operationId":"resend_verification_email","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResendVerificationParams"}}},"required":true},"responses":{"200":{"description":"Verification email re-sent (if user exists and is not verified)"}},"security":[{}]}},"/api/auth/reset":{"post":{"summary":"reset user password by the given parameters","operationId":"reset","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetParams"}}},"required":true},"responses":{"200":{"description":"Password has been reset successfully"},"400":{"description":"Invalid token or request"}},"security":[{}]}},"/api/auth/verify/{token}":{"get":{"summary":"Verify register user. if the user not verified his email, he can't login to\nthe system.","operationId":"verify","parameters":[{"name":"token","in":"path","description":"Email verification token","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Email verified successfully"},"401":{"description":"Invalid or expired token"}},"security":[{}]}}},"components":{"schemas":{"CurrentResponse":{"type":"object","required":["pid","name","email"],"properties":{"email":{"type":"string"},"name":{"type":"string"},"pid":{"type":"string"}}},"ForgotParams":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","example":"user@example.com"}}},"LoginParams":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","example":"user@example.com"},"password":{"type":"string"}}},"LoginResponse":{"type":"object","required":["token","pid","name","is_verified"],"properties":{"is_verified":{"type":"boolean"},"name":{"type":"string"},"pid":{"type":"string"},"token":{"type":"string"}}},"MagicLinkParams":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","example":"user@example.com"}}},"RegisterParams":{"type":"object","required":["email","password","name"],"properties":{"email":{"type":"string","format":"email","example":"user@example.com"},"name":{"type":"string","minLength":2},"password":{"type":"string"}}},"ResendVerificationParams":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","example":"user@example.com"}}},"ResetParams":{"type":"object","required":["token","password"],"properties":{"password":{"type":"string"},"token":{"type":"string"}}}},"securitySchemes":{"api_key":{"type":"apiKey","in":"header","name":"apikey"},"jwt_token":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}